# Расчетно-графическая работа по функциональному анализу

**Выполнил:** Калюжный Михаил Сергеевич  
**Группа:** М8О-308Б-22  
**Задание:** №2  
**Вариант:** 8  

---
## Условие задачи

Вычислить интеграл Лебега–Стиельтъеса:

$$
\int_{a}^{b} f(x)\, dF(x)
$$

где:
- $[a, b] = [-3k, 3l]$
- $f(x) = e^{kx} - 3 \cdot \chi\left(4x + \frac{l}{5}\right) + 3x^2$
- $F(x) = e^x + \chi(x - 1) + 2 \cdot \chi(x - k) + x^2 \cdot \text{sgn}(x)$
- $k = 8,\ l = 15$

Здесь:
- $\chi(x)$ — функция Хевисайда
- $\text{sgn}(x)$ — функция знака числа
---

## Алгоритм решения

1. Подынтегральная функция \(f(x)\) и функция \(F(x)\) имеют точки разрыва — учтём это при интегрировании.
2. Интеграл разбивается на участки, где \(F(x)\) дифференцируема.
3. На каждом участке используем классическую формулу интегрирования с производной \(F'(x)\).
4. В точках скачков \(F(x)\) добавляем вклад вида \(f(x_i) \cdot \Delta F(x_i)\).
5. Используем численное интегрирование с помощью `scipy.integrate.quad`.

---

## Реализация на Python

```import numpy as np
from scipy.integrate import quad

# параметры
k = 8
l = 15
a = -3 * k
b = 3 * l

# функция Хевисайда
def heaviside(x):
    return 1.0 * (x >= 0)

# функция f(x)
def f(x):
    return np.exp(k * x) - 3 * heaviside(4 * x + l / 5) + 3 * x**2

# производная F(x) почти везде (не в точках разрыва)
def F_prime(x):
    return np.exp(x) + 2 * abs(x) / x  # x^2 sgn(x) производная: 2x sgn(x) + x^2 * delta(0), игнорируем дельта

# основной интеграл по участкам без разрывов
def continuous_integral():
    # точки разрыва F(x): x = 1, x = k
    jump_points = [1, k]
    intervals = [a, 1, k, b]

    result = 0
    for i in range(len(intervals) - 1):
        left = intervals[i]
        right = intervals[i + 1]
        if right in jump_points:
            right -= 1e-8  # избежать скачка
        result += quad(lambda x: f(x) * F_prime(x), left, right)[0]
    return result

# скачки в F(x)
def jump_contributions():
    jumps = {
        1: 1,      # jump from χ(x - 1)
        k: 2       # jump from 2χ(x - k)
    }
    result = 0
    for point, jump in jumps.items():
        result += f(point) * jump
    return result

# итоговый интеграл
I = continuous_integral() + jump_contributions()
print(f"Значение интеграла: {I:.6f}")

```
## Вывод консоли
```
PS C:\Users\Пользователь\MAI_study\fan> & C:/Users/Пользователь/AppData/Local/Programs/Python/Python311/python.exe c:/Users/Пользователь/MAI_study/fan/2_lab.py
Значение интеграла: 8610386797958408037325859223534060654063471647766808695987414508005738911720819715447657221077124652889053024822080882107882500415082902348174894792400897286832866490769735680.000000
```
## Вывод

Результат численного интегрирования оказался чрезвычайно большим, порядка \(10^{174}\). Это связано с экспоненциальной составляющей функции \(f(x) = e^{8x}\), которая быстро растёт на отрезке \([-24, 45]\). Интеграл корректно учитывает скачки в функции \(F(x)\), и итоговое значение получено с учётом всех особенностей.
